{% extends 'base.html' %}
{% load static %}

{% block main_text %}
  Rapoarte sesizări
{% endblock %}
{% block content %}

<!-- Start block -->
<section class="bg-gray-50 dark:bg-gray-900 p-3 sm:p-5 antialiased">
  <div class="mx-auto max-w-screen-2xl px-4 lg:px-12">
    
    <div class="flex flex-col lg:grid lg:grid-cols-4 gap-4">

      <div id="accordion-nested-parent" data-accordion="collapse" class="col-span-1 px-3 pt-1">
        <h2 id="accordion-collapse-heading-1">
          <button type="button" class="flex items-center justify-between w-full p-5 font-medium rtl:text-right text-gray-500 border border-gray-200 rounded-t-xl focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 gap-3" data-accordion-target="#accordion-collapse-body-1" aria-expanded="true" aria-controls="accordion-collapse-body-1">
            <span>Filtrează</span>
            <svg data-accordion-icon class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
            </svg>
          </button>
        </h2>
        <div id="accordion-collapse-body-1" class="hidden" aria-labelledby="accordion-collapse-heading-1">
          <div class="p-5 border border-gray-200 dark:border-gray-700 dark:bg-gray-900">
            <form hx-get="{% url 'dash_list' %}"
                  hx-target="#tabel-sesizari"
                  hx-swap="innerHTML"
                  hx-on:htmx:after-request="initFlowbite();"
                  id="filterForm"
                  class="h-auto overflow-y-scroll">
        
              <div class="text-black dark:text-white">

                <!-- Status -->
                <div id="status-filter" data-accordion="collapse">
                  <h2 id="status-filter-heading">
                    <button type="button" class="flex items-center justify-between w-full p-5 rounded-t-xl font-medium rtl:text-right text-gray-500 border border-b-0 border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 gap-3" data-accordion-target="#status-filter-body" aria-expanded="false" aria-controls="status-filter-body">
                      <span>Status</span>
                      <svg data-accordion-icon class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                      </svg>
                    </button>
                  </h2>

                  <div id="status-filter-body" class="hidden" aria-labelledby="status-filter-heading">
                    <div class="p-2 font-light border-b border-gray-200 dark:border-gray-600">
                      <ul class="space-y-2">
                        {% for pk, check in filter.form.sesizare_status.field.widget.choices %}
                          <li class="flex items-center">
                            <input type="checkbox"
                                    name="{{filter.form.sesizare_status.name}}"
                                    value="{{pk}}"
                                    id="id_{{filter.form.sesizare_status.name}}_{{ forloop.counter0 }}"
                                    class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500"
                              {% if filter.form.sesizare_status.data %}
                                {% for data in filter.form.sesizare_status.data %}
                                  {% if data|slugify == pk|slugify %}
                                    checked="checked"
                                  {% endif %}
                                {% endfor %}
                              {% endif %}
                            >
                            </input>
                            <label for="id_{{filter.form.sesizare_status.name}}_{{ forloop.counter0 }}" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100">
                              {{ check }}
                              {% for s in status %}
                                {% if s.status == pk %}
                                  - {{s.status_count}}
                                {% endif %}
                              {% endfor %}
                            </label>
                          </li>
                        {% endfor %}
                      </ul>
                    </div>
                  </div>
                </div>

                <!-- Tip conflict -->
                <div id="conflict-filter" data-accordion="collapse">
                  <h2 id="conflict-filter-heading">
                    <button type="button" class="flex items-center justify-between w-full p-5 font-medium rtl:text-right text-gray-500 border border-b-0 border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 gap-3" data-accordion-target="#conflict-filter-body" aria-expanded="false" aria-controls="conflict-filter-body">
                      <span>Tip conflict</span>
                      <svg data-accordion-icon class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                      </svg>
                    </button>
                  </h2>
                  <div id="conflict-filter-body" class="hidden" aria-labelledby="conflict-filter-heading"> 
                    <div class="p-2 font-light border-b border-gray-200 dark:border-gray-600">
                      <ul class="space-y-2">
                        {% for pk, check in filter.form.tip_conflict.field.widget.choices %}
                          <li class="flex items-center">
                            <input type="checkbox"
                                    name="{{filter.form.tip_conflict.name}}"
                                    value="{{pk}}"
                                    id="id_{{filter.form.tip_conflict.name}}_{{ forloop.counter0 }}"
                                    class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500"
                                    {% if filter.form.tip_conflict.data %}
                                      {% for data in filter.form.tip_conflict.data %}
                                        {% if data|slugify == pk|slugify %}
                                          checked="checked"
                                        {% endif %}
                                      {% endfor %}
                                    {% endif %}
                                    >
                              </input>
                            <label for="id_{{filter.form.tip_conflict.name}}_{{ forloop.counter0 }}" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100">
                              {{ check }}
                              {% for s in conflict %}
                                {% if s.raportvoluntar__tip_conflict == pk %}
                                  - {{s.conflict_count}}
                                {% endif %}
                              {% endfor %}
                            </label>
                          </li>
                        {% endfor %}
                      </ul>
                    </div>
                  </div>
                </div>

                <!-- Start Data sesizare -->
                <div id="start-filter" data-accordion="collapse">
                  <h2 id="start-filter-heading">
                    <button type="button" class="flex items-center justify-between w-full p-5 font-medium rtl:text-right text-gray-500 border border-b-0 border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 gap-3" data-accordion-target="#start-filter-body" aria-expanded="false" aria-controls="start-filter-body">
                      <span>Data</span>
                      <svg data-accordion-icon class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                      </svg>
                    </button>
                  </h2>
                  <div id="start-filter-body" class="hidden" aria-labelledby="start-filter-heading">
                    
                    <div id="date-range-picker" class="flex justify-center items-center px-2 py-4">
                    
                      <div class="relative">
                        <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
                          <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"/>
                          </svg>
                        </div>
                        {{filter.form.start_date}}
                      </div>
                      
                      <div class="relative ml-3">
                        <div class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none">
                          <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"/>
                          </svg>
                        </div>
                        {{filter.form.end_date}}
                      </div>
                    
                    </div>
                  </div>
                </div>

                <!-- Voluntar -->
                <div id="voluntar-filter" data-accordion="collapse">
                  <h2 id="voluntar-filter-heading">
                    <button type="button" class="flex items-center justify-between w-full p-5 font-medium rtl:text-right text-gray-500 border border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 gap-3" data-accordion-target="#voluntar-filter-body" aria-expanded="false" aria-controls="voluntar-filter-body">
                      <span>Voluntar</span>
                      <svg data-accordion-icon class="w-3 h-3 rotate-180 shrink-0" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5 5 1 1 5"/>
                      </svg>
                    </button>
                  </h2>
                  <div id="voluntar-filter-body" class="hidden", aria-label="voluntar-filter-heading">
                    <div class="p-2 space-y-2 font-light border-b border-gray-200 dark:border-gray-600">
                      <ul class="space-y-2">
                      {% for pk, check in filter.form.sesizare_voluntar.field.widget.choices %}
                        <li class="flex items-center">
                          <input type="checkbox"
                                  name="{{filter.form.sesizare_voluntar.name}}"
                                  value="{{pk}}"
                                  id="id_{{filter.form.sesizare_voluntar.name}}_{{ forloop.counter0 }}"
                                  class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 dark:focus:ring-primary-600 dark:ring-offset-gray-700 focus:ring-2 dark:bg-gray-600 dark:border-gray-500"
                                  {% if filter.form.sesizare_voluntar.data %}
                                    {% for data in filter.form.sesizare_voluntar.data %}
                                      {% if data|slugify == pk|slugify %}
                                        checked="checked"
                                      {% endif %}
                                    {% endfor %}
                                  {% endif %}
                                  ></input>
                          <label for="id_{{filter.form.sesizare_voluntar.name}}_{{ forloop.counter0 }}" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100">
                            {{ check }}
                          </label>
                        </li>
                      {% endfor %}
                      </ul>
                    </div>
                  </div>
                </div>
                    
              </div>
              <button type="submit" class="my-2 py-2 px-3 flex items-center text-sm font-medium text-center text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-primary-700 focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:hover:text-gray-400 dark:hover:bg-gray-800">
                <svg class="w-4 h-4 mr-2 -ml-0.5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" />
                  <path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" />
                </svg>Filtrează
              </button>
            </form>
          </div>
        </div>
      </div>

      <div id="tabel-sesizari" class="col-span-3">
        {% include 'dashboard/partials/tabel_raport.html' %}
      </div>

    </div>
  </div>
</section>
<!-- End block -->
  
{% endblock %}
